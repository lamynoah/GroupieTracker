<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>loading</title>
</head>

<body>
    <div> En attente que les autres joueurs rejoignent </div>
    {{if . }}<button onclick="socket.send(JSON.stringify({ Id:getRoomId(), Start: true, id_user : Number.parseInt(getCookie('Id')) }))" disabled>Start all</button>{{end}}
    {{template "socket" "loading"}}
    {{if . }}
    <script>
        socket.onopen = () => {
            socket.send(JSON.stringify({ Id: getRoomId(), Start: false }))
            document.querySelector("button").removeAttribute("disabled")
        }
        socket.onmessage = msg => {
            console.log(msg.data)
            if (JSON.parse(msg.data) === "start game") {
                window.location.replace("http://localhost:8080/ptitBac" + window.location.search);
            }
        }
    </script>
    {{else}}
    <script>
        socket.onopen = () => {
            socket.send(JSON.stringify({ Id: getRoomId(), Start: false }))
        }
        socket.onmessage = msg => {
            console.log(msg.data)
            if (JSON.parse(msg.data) === "start game") {
                window.location.replace("http://localhost:8080/ptitBac" + window.location.search);
            }
        }
    </script>
    {{end}}
    
</body>

</html>